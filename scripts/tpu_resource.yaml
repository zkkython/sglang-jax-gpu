resources:
  accelerators: $ACCELERATOR
  use_spot: True
  disk_size: 512  # Ensure model checkpoints can fit.
  disk_tier: best

secrets:
  USERNAME: null
  GIT_TOKEN: null


setup: |
  if [ -d "sglang-jax" ]; then pip uninstall -y sgl-jax || true && rm -rf sglang-jax; fi
  git clone https://${USERNAME}:${GIT_TOKEN}@github.com/sgl-project/sglang-jax.git
  cd sglang-jax && git fetch origin $REF:$REF && git checkout $REF
  uv venv --python 3.12
  source .venv/bin/activate
  uv pip install -e python/
  bash scripts/killall_sglang.sh
